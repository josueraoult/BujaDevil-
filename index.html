<!DOCTYPE html>
<html lang="fr" class="h-full scroll-smooth">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>BujaDevil ‚Äî Blog Moderne 2025</title>
  <meta name="description" content="Blog moderne 2025: News, Gaming, Apps, Tutorials. UI/UX avanc√©, SEO, Accessibilit√©, Admin, Communaut√©." />
  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Ccircle cx='32' cy='32' r='28' fill='%23099DFD'/%3E%3Ctext x='32' y='38' text-anchor='middle' font-size='28' fill='white' font-family='Arial'%3EB%3C/text%3E%3C/svg%3E" />

  <!-- Fonts -->
  <link rel="preconnect" href="https://rsms.me/" />
  <link rel="stylesheet" href="https://rsms.me/inter/inter.css" />
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">

  <!-- Tailwind CSS (CDN) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    // Tailwind config
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          fontFamily: {
            sans: ['Inter', 'system-ui', 'sans-serif'],
            mono: ['JetBrains Mono', 'monospace'],
          },
          colors: {
            brand: {
              50: '#EBF8FF',
              100: '#D1EEFE',
              200: '#A7D8F0',
              300: '#7CC1E4',
              400: '#52A9E3',
              500: '#099DFD',
              600: '#0A84D6',
              700: '#0B6EB1',
              800: '#0D568C',
              900: '#0E446F',
            },
            cyanAcc: '#06b6d4',
            category: {
              news: '#3b82f6',
              gaming: '#a78bfa',
              apps: '#22c55e',
              tutorials: '#f59e0b',
            }
          },
          boxShadow: {
            soft: '0 10px 25px -10px rgba(9, 157, 253, 0.25)',
          }
        }
      }
    }
  </script>

  <!-- Base styles -->
  <style>
    :root {
      color-scheme: light dark;
    }
    html, body { height: 100%; }
    /* Auto dark-mode based on system preference but persist via localStorage */
    /* Gradient borders for cards */
    .gradient-border {
      position: relative;
      border-radius: 0.75rem;
      padding: 1px;
      background: linear-gradient(135deg, #099DFD, #06b6d4);
    }
    .gradient-border > .inner {
      border-radius: 0.75rem;
      background: var(--tw-bg-opacity, 1) var(--tw-bg-color, transparent);
    }
    /* Smooth transitions */
    .transition-all { transition: all 250ms ease; }
    /* Tooltip */
    .tooltip[data-tip]:hover::after {
      content: attr(data-tip);
      position: absolute;
      top: -2.2rem;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(20,20,25,0.9);
      color: #fff;
      padding: 6px 10px;
      border-radius: 6px;
      font-size: 12px;
      white-space: nowrap;
      pointer-events: none;
    }
    /* Reading progress bar */
    #readingProgress {
      position: fixed; top: 0; left: 0; height: 4px;
      background: linear-gradient(90deg, #099DFD, #06b6d4);
      width: 0%;
      z-index: 1000;
    }
    /* Blur header */
    .blur-header {
      backdrop-filter: saturate(180%) blur(10px);
      background-color: rgba(255,255,255,0.6);
    }
    .dark .blur-header {
      background-color: rgba(10,15,20,0.45);
    }
    /* Breadcrumbs */
    .breadcrumbs a { color: inherit; }
  </style>

  <!-- Basic SEO + JSON-LD -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Blog",
    "name": "BujaDevil",
    "url": "https://example.com",
    "description": "Blog moderne 2025: News, Gaming, Apps, Tutorials.",
    "inLanguage": "fr-FR",
    "publisher": {
      "@type": "Person",
      "name": "Josu√©",
      "sameAs": ["https://github.com/", "https://twitter.com/"]
    }
  }
  </script>

  <!-- Babel standalone for JSX/TS in-browser -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <!-- React + ReactDOM -->
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <!-- Vue for reactions widget -->
  <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>

  <!-- GA4 / Hotjar placeholders (replace with real IDs) -->
  <script>
    // window.dataLayer = window.dataLayer || [];
    // function gtag(){dataLayer.push(arguments);}
    // gtag('js', new Date());
    // gtag('config', 'G-XXXXXXXXXX');
    // window.hj=window.hj||function(){(hj.q=hj.q||[]).push(arguments)};
    // hj('init', 'HOTJAR_ID');
  </script>
</head>
<body class="bg-white text-slate-900 dark:bg-slate-950 dark:text-slate-100">
  <div id="readingProgress"></div>
  <div id="app"></div>

  <!-- Vue reactions widget root -->
  <div id="vue-reactions-root" class="hidden"></div>

  <!-- App Script -->
  <script type="text/babel" data-presets="env,react,typescript">
    // Types (minimal to satisfy TS flavor)
    type Category = 'News' | 'Gaming' | 'Apps' | 'Tutorials';
    type Post = {
      id: string;
      title: string;
      excerpt: string;
      content: string;
      category: Category;
      tags: string[];
      cover: string;
      date: string;
      readingTime: number;
      views: number;
      reactions: { like: number; love: number; useful: number; };
    };
    type UserProfile = {
      id: string; name: string; avatar?: string; bio?: string;
      socials?: { github?: string; twitter?: string; website?: string };
      prefs?: { theme?: 'system'|'light'|'dark'; focus?: boolean; fontSize?: number; };
      bookmarks?: string[];
      achievements?: string[];
      online?: boolean;
      notifications?: { newsletter?: boolean; comments?: boolean; };
      activity?: { lastLogin?: string; commentsCount?: number; };
    };

    // Utils
    const uid = () => Math.random().toString(36).slice(2);
    const nowISO = () => new Date().toISOString();
    const clamp = (v:number, min:number, max:number) => Math.min(Math.max(v, min), max);

    // Local storage keys
    const LS = {
      posts: 'bd.posts',
      profile: 'bd.profile',
      comments: 'bd.comments', // map postId -> array
      searches: 'bd.searches',
      analytics: 'bd.analytics', // simple aggregates
      prefs: 'bd.prefs',
    };

    // Seed content if empty
    const defaultPosts: Post[] = Array.from({length: 28}).map((_,i) => {
      const cats: Category[] = ['News','Gaming','Apps','Tutorials'];
      const c = cats[i % cats.length];
      const id = `p_${i+1}`;
      return {
        id,
        title: `${c} ‚Äî ${['Next-level','Deep Dive','Pro Tips','Breaking','Ultimate'][i%5]} #${i+1}`,
        excerpt: `R√©sum√© rapide de l'article ${i+1} sur ${c}.`,
        content: `# ${c} Article ${i+1}\n\nUn contenu riche avec **typographie**, code, images, et table des mati√®res.\n\n## Section A\nD√©tails.\n\n## Section B\nPlus de d√©tails.\n\n\`\`\`js\nconsole.log('syntax highlighting');\n\`\`\`\n`,
        category: c,
        tags: ['React','Tailwind','2025','Design','SEO'].slice(0, 2 + (i%3)),
        cover: `https://picsum.photos/seed/${i+100}/1200/600`,
        date: new Date(Date.now() - i*86400000).toISOString(),
        readingTime: 3 + (i%6),
        views: 50 + i*13,
        reactions: { like: i%7, love: i%5, useful: i%9 },
      };
    });

    const defaultProfile: UserProfile = {
      id: 'u_1',
      name: 'Josu√©',
      avatar: 'https://i.pravatar.cc/160?img=12',
      bio: 'Final-year student & web builder. BujaDevil ‚Äî modern, fast, and inspiring.',
      socials: { github: 'https://github.com/yourhandle', twitter: 'https://twitter.com/yourhandle', website: 'https://your.site' },
      prefs: { theme: 'system', focus: false, fontSize: 16 },
      bookmarks: [],
      achievements: ['Early Adopter', 'Top Reader', 'Community Builder'],
      online: true,
      notifications: { newsletter: true, comments: true },
      activity: { lastLogin: nowISO(), commentsCount: 0 },
    };

    const readLS = <T,>(k:string, fallback:T): T => {
      try { const v = localStorage.getItem(k); return v ? JSON.parse(v) : fallback; } catch { return fallback; }
    };
    const writeLS = (k:string, v:unknown) => { localStorage.setItem(k, JSON.stringify(v)); };

    // Initialize storage
    const posts = readLS<Post[]>(LS.posts, defaultPosts);
    const profile = readLS<UserProfile>(LS.profile, defaultProfile);
    const commentsMap = readLS<Record<string, any[]>>(LS.comments, {});
    const searchesHist = readLS<string[]>(LS.searches, []);
    const analytics = readLS(LS.analytics, { visits: 0, pageViews: 0, sessionDurations: [], popular: {}, sources: {} });
    const prefs = readLS(LS.prefs, { theme: profile.prefs?.theme ?? 'system', focus: profile.prefs?.focus ?? false, fontSize: profile.prefs?.fontSize ?? 16 });

    // Theme init
    const applyTheme = (mode: 'system'|'light'|'dark') => {
      const root = document.documentElement;
      const sysDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
      const isDark = mode === 'dark' || (mode === 'system' && sysDark);
      root.classList.toggle('dark', isDark);
    };
    applyTheme(prefs.theme);

    // Router
    const routes = {
      '/': 'Home',
      '/blog': 'Blog',
      '/post': 'Post', // expects ?id=
      '/about': 'About',
      '/admin': 'Admin',
      '/profile': 'Profile',
    };

    const parseHash = () => {
      const h = location.hash.replace('#','') || '/';
      const [path, qs] = h.split('?');
      const params = Object.fromEntries(new URLSearchParams(qs || '').entries());
      return { path, params };
    };
    const navigate = (to:string) => { location.hash = to; };

    // Infinite scroll utility
    const infiniteSlice = (arr:any[], page:number, size:number) => arr.slice(0, page*size);

    // Search util with autocomplete
    const searchPosts = (q:string, filters:any) => {
      const needle = q.trim().toLowerCase();
      let res = posts.filter(p =>
        (!needle || p.title.toLowerCase().includes(needle) || p.excerpt.toLowerCase().includes(needle) || p.tags.join(' ').toLowerCase().includes(needle))
        && (!filters.category || p.category === filters.category)
        && (!filters.popularity || p.views >= (filters.popularity==='high'?200:100))
        && (!filters.date || new Date(p.date) >= new Date(filters.date))
      );
      if (needle) {
        const last = searchesHist[searchesHist.length-1];
        if (last !== needle) {
          writeLS(LS.searches, [...searchesHist.slice(-19), needle]); // keep 20
        }
      }
      return res;
    };

    // Autocomplete suggestions
    const suggest = (q:string) => {
      const lower = q.toLowerCase();
      const pool = Array.from(new Set(posts.flatMap(p => [p.title, ...p.tags])));
      return pool.filter(s => s.toLowerCase().includes(lower)).slice(0,8);
    };

    // Reading progress
    const updateReadingProgress = () => {
      const el = document.getElementById('readingProgress');
      if (!el) return;
      const scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
      const height = (document.documentElement.scrollHeight - document.documentElement.clientHeight);
      const pct = height ? (scrollTop / height) * 100 : 0;
      el.style.width = pct + '%';
    };
    window.addEventListener('scroll', updateReadingProgress);

    // Analytics mock
    const tickView = (route:string) => {
      analytics.visits += 1;
      analytics.pageViews += 1;
      analytics.sources['direct'] = (analytics.sources['direct']||0)+1;
      writeLS(LS.analytics, analytics);
      // Popular posts update when viewing single post
    };

    // Components
    const Badge = ({label, color}:{label:string;color:string}) => (
      <span className="inline-flex items-center rounded-md px-2 py-1 text-xs font-medium"
        style={{ backgroundColor: color+'20', color }}
      >
        {label}
      </span>
    );

    const CategoryBadge = ({cat}:{cat:Category}) => {
      const colorMap:any = { News: 'var(--news, #3b82f6)', Gaming: '#a78bfa', Apps: '#22c55e', Tutorials: '#f59e0b' };
      return <Badge label={cat} color={colorMap[cat]} />;
    };

    const Icon = ({name, className}:{name:string;className?:string}) => {
      const path:any = {
        search: "M11 19l-5 5m14-8a7 7 0 11-14 0 7 7 0 0114 0z",
        user: "M16 14a4 4 0 10-8 0 4 4 0 008 0z M12 14c-4.418 0-8 3.134-8 7h16c0-3.866-3.582-7-8-7z",
        sun: "M12 18a6 6 0 100-12 6 6 0 000 12z M12 2v2m0 16v2m10-10h-2M4 12H2m15.364-7.364l-1.414 1.414M6.05 17.95l-1.414 1.414M18.364 17.95l-1.414-1.414M6.05 6.05L4.636 4.636",
        moon: "M21 12.79A9 9 0 1111.21 3c.1 0 .2 0 .3.01A7 7 0 0021 12.79z",
        heart: "M20.84 4.61a5.5 5.5 0 00-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 10-7.78 7.78L12 21.23l8.84-8.84a5.5 5.5 0 000-7.78z",
        bookmark: "M5 3v18l7-5 7 5V3z",
        share: "M4 12v8a2 2 0 002 2h12a2 2 0 002-2v-8M16 6l-4-4-4 4M12 2v13",
        chevronRight: "M9 5l7 7-7 7",
        chevronLeft: "M15 19l-7-7 7-7",
        menu: "M4 6h16M4 12h16M4 18h16",
        close: "M6 18L18 6M6 6l12 12",
      };
      return (
        <svg className={className||"w-5 h-5"} fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24" aria-hidden="true">
          <path strokeLinecap="round" strokeLinejoin="round" d={path[name]||path.search} />
        </svg>
      );
    };

    // Header + nav
    const Header = ({onThemeToggle}:{onThemeToggle:()=>void}) => {
      const [open, setOpen] = React.useState(false);
      return (
        <header className="fixed top-0 inset-x-0 z-50 blur-header border-b border-slate-200/40 dark:border-slate-800/40">
          <div className="mx-auto max-w-6xl px-4 sm:px-6 lg:px-8">
            <div className="flex h-14 items-center justify-between">
              <div className="flex items-center gap-3">
                <a href="#/" className="font-bold text-brand-600 dark:text-brand-400">BujaDevil</a>
                <nav className="hidden md:flex items-center gap-6 text-sm text-slate-600 dark:text-slate-300">
                  <a href="#/blog">Blog</a>
                  <a href="#/about">√Ä propos</a>
                  <a href="#/admin">Admin</a>
                  <a href="#/profile">Profil</a>
                </nav>
              </div>
              <div className="flex items-center gap-2">
                <button onClick={onThemeToggle} className="tooltip relative rounded-md px-2 py-2 hover:bg-slate-100 dark:hover:bg-slate-800 transition-all" data-tip="Th√®me">
                  <Icon name="sun" className="w-5 h-5 hidden dark:block" />
                  <Icon name="moon" className="w-5 h-5 dark:hidden" />
                </button>
                <button onClick={() => setOpen(!open)} className="md:hidden rounded-md p-2 hover:bg-slate-100 dark:hover:bg-slate-800 transition-all" aria-label="Menu">
                  {open ? <Icon name="close" /> : <Icon name="menu" />}
                </button>
              </div>
            </div>
            {open && (
              <div className="md:hidden pb-4">
                <div className="flex flex-col gap-2 text-sm">
                  <a href="#/blog" className="px-3 py-2 rounded hover:bg-slate-100 dark:hover:bg-slate-800">Blog</a>
                  <a href="#/about" className="px-3 py-2 rounded hover:bg-slate-100 dark:hover:bg-slate-800">√Ä propos</a>
                  <a href="#/admin" className="px-3 py-2 rounded hover:bg-slate-100 dark:hover:bg-slate-800">Admin</a>
                  <a href="#/profile" className="px-3 py-2 rounded hover:bg-slate-100 dark:hover:bg-slate-800">Profil</a>
                </div>
              </div>
            )}
          </div>
        </header>
      );
    };

    // Footer
    const Footer = () => (
      <footer className="mt-16 border-t border-slate-200/50 dark:border-slate-800/50">
        <div className="mx-auto max-w-6xl px-4 py-8 flex flex-col sm:flex-row items-center justify-between gap-4 text-sm text-slate-600 dark:text-slate-300">
          <div>¬© {new Date().getFullYear()} BujaDevil ‚Äî Built with React + Tailwind</div>
          <div className="flex items-center gap-3">
            <a href="#" className="hover:text-brand-500">Twitter</a>
            <a href="#" className="hover:text-brand-500">GitHub</a>
            <a href="#" className="hover:text-brand-500">YouTube</a>
            <a href="#" className="hover:text-brand-500">Mail</a>
          </div>
        </div>
      </footer>
    );

    // Hero
    const Hero = () => (
      <section className="pt-24 pb-8">
        <div className="mx-auto max-w-6xl px-4">
          <div className="rounded-2xl p-1 gradient-border shadow-soft">
            <div className="inner rounded-2xl bg-white/80 dark:bg-slate-900/60 p-6 sm:p-10">
              <div className="flex flex-col md:flex-row items-center gap-6">
                <img src={profile.avatar} alt="Josu√© avatar" className="w-24 h-24 rounded-full ring-4 ring-brand-200 dark:ring-brand-700" />
                <div className="flex-1">
                  <h1 className="text-3xl sm:text-4xl font-extrabold tracking-tight">Salut, je suis Josu√© ‚Äî Builder de web apps modernes</h1>
                  <p className="mt-3 text-slate-600 dark:text-slate-300">Je con√ßois des interfaces rapides, accessibles et √©l√©gantes. Bienvenue sur BujaDevil: News, Gaming, Apps, Tutorials.</p>
                  <div className="mt-4 flex flex-wrap gap-2">
                    <Badge label="React" color="#61dafb" />
                    <Badge label="Tailwind" color="#38bdf8" />
                    <Badge label="SEO" color="#16a34a" />
                    <Badge label="UX" color="#f59e0b" />
                  </div>
                </div>
                <div className="w-full md:w-auto">
                  <a href="#/blog" className="inline-flex items-center gap-2 rounded-lg bg-brand-600 text-white px-4 py-3 hover:bg-brand-500 transition-all">
                    Explorer le blog <Icon name="chevronRight" />
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
    );

    // Newsletter CTA
    const NewsletterCTA = () => {
      const [email, setEmail] = React.useState('');
      const [ok, setOk] = React.useState(false);
      return (
        <section className="mx-auto max-w-6xl px-4">
          <div className="rounded-xl border border-slate-200 dark:border-slate-800 p-6 flex flex-col md:flex-row items-center justify-between gap-4 bg-slate-50 dark:bg-slate-900/40">
            <div>
              <h3 className="text-xl font-bold">Rejoins la newsletter</h3>
              <p className="text-sm text-slate-600 dark:text-slate-300">Actualit√©s, tutoriels, et apps ‚Äî directement dans ta bo√Æte.</p>
            </div>
            <div className="flex gap-2">
              <input value={email} onChange={e=>setEmail(e.target.value)} placeholder="ton@email"
                className="rounded-md px-3 py-2 bg-white dark:bg-slate-800 border border-slate-300 dark:border-slate-700 outline-none focus:ring-2 focus:ring-brand-400"
              />
              <button onClick={()=>{ setOk(true); }} className="rounded-md px-4 py-2 bg-brand-600 text-white hover:bg-brand-500 transition-all">S'inscrire</button>
            </div>
            {ok && <div className="text-xs text-green-600 dark:text-green-400">Inscription enregistr√©e (mock Mailchimp/ConvertKit)</div>}
          </div>
        </section>
      );
    };

    // Post card
    const PostCard = ({p}:{p:Post}) => {
      const bookmarked = profile.bookmarks?.includes(p.id);
      const toggleBookmark = () => {
        const set = new Set(profile.bookmarks||[]);
        if (set.has(p.id)) set.delete(p.id); else set.add(p.id);
        profile.bookmarks = Array.from(set);
        writeLS(LS.profile, profile);
      };
      return (
        <article className="rounded-xl overflow-hidden border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 transition-all hover:shadow-md hover:-translate-y-0.5">
          <a href={`#/post?id=${p.id}`} aria-label={p.title}>
            <img loading="lazy" src={p.cover} alt={p.title} className="w-full h-40 object-cover" />
          </a>
          <div className="p-4">
            <div className="flex items-center justify-between">
              <CategoryBadge cat={p.category} />
              <span className="text-xs text-slate-500 dark:text-slate-400">{new Date(p.date).toLocaleDateString('fr-FR')} ‚Ä¢ {p.readingTime} min</span>
            </div>
            <h3 className="mt-2 text-lg font-bold line-clamp-2">
              <a href={`#/post?id=${p.id}`}>{p.title}</a>
            </h3>
            <p className="mt-1 text-sm text-slate-600 dark:text-slate-300 line-clamp-3">{p.excerpt}</p>
            <div className="mt-3 flex items-center justify-between">
              <div className="flex flex-wrap gap-1">
                {p.tags.slice(0,3).map(t => <Badge key={t} label={t} color="#64748b" />)}
              </div>
              <button onClick={toggleBookmark} className="tooltip relative rounded-md p-2 hover:bg-slate-100 dark:hover:bg-slate-800" data-tip={bookmarked ? 'Retirer des favoris' : 'Ajouter aux favoris'}>
                <Icon name="bookmark" className={bookmarked ? "w-5 h-5 text-brand-600" : "w-5 h-5"} />
              </button>
            </div>
          </div>
        </article>
      );
    };

    // Table of contents from markdown headings
    const extractTOC = (md:string) => {
      const lines = md.split('\n');
      const toc:any[] = [];
      lines.forEach((l,i) => {
        const m = /^(\#{1,6})\s+(.*)/.exec(l);
        if (m) toc.push({ level: m[1].length, text: m[2], anchor: `h-${i}` });
      });
      return toc;
    };

    // Minimal markdown renderer
    const Markdown = ({md}:{md:string}) => {
      const lines = md.split('\n');
      return (
        <div className="prose prose-slate dark:prose-invert max-w-none">
          {lines.map((l,i)=>{
            const h = /^(\#{1,6})\s+(.*)/.exec(l);
            if (h) {
              const L = h[1].length, T = h[2];
              const Tag:any = `h${L}`;
              return <Tag key={i} id={`h-${i}`}>{T}</Tag>;
            }
            if (l.startsWith('```')) return <pre key={i} className="bg-slate-900 text-slate-100 p-3 rounded-md overflow-auto"><code>syntax highlighting demo</code></pre>;
            return <p key={i}>{l}</p>;
          })}
        </div>
      );
    };

    // Comments section
    const Comments = ({postId}:{postId:string}) => {
      const [list, setList] = React.useState<any[]>(commentsMap[postId]||[]);
      const [text, setText] = React.useState('');
      const add = () => {
        if (!text.trim()) return;
        const c = { id: uid(), user: profile.name, avatar: profile.avatar, text, date: nowISO(), replies: [] };
        const next = [c, ...list];
        commentsMap[postId] = next;
        writeLS(LS.comments, commentsMap);
        setList(next);
        setText('');
        profile.activity = {...profile.activity, commentsCount: (profile.activity?.commentsCount||0)+1 };
        writeLS(LS.profile, profile);
      };
      return (
        <div className="mt-8">
          <h3 className="text-xl font-bold">Commentaires</h3>
          <div className="mt-3 flex gap-2">
            <img src={profile.avatar} alt="" className="w-8 h-8 rounded-full" />
            <input value={text} onChange={e=>setText(e.target.value)} placeholder="Ton commentaire..."
              className="flex-1 rounded-md px-3 py-2 bg-white dark:bg-slate-800 border border-slate-300 dark:border-slate-700 outline-none focus:ring-2 focus:ring-brand-400"
            />
            <button onClick={add} className="rounded-md px-4 py-2 bg-brand-600 text-white hover:bg-brand-500">Envoyer</button>
          </div>
          <div className="mt-4 space-y-4">
            {list.map(c=>(
              <div key={c.id} className="rounded-lg border border-slate-200 dark:border-slate-800 p-3">
                <div className="flex items-center gap-2">
                  <img src={c.avatar} alt="" className="w-6 h-6 rounded-full" />
                  <div className="text-sm font-medium">{c.user}</div>
                  <div className="text-xs text-slate-500 ml-auto">{new Date(c.date).toLocaleString('fr-FR')}</div>
                </div>
                <p className="mt-2 text-sm">{c.text}</p>
                <div className="mt-2 flex gap-3 text-xs">
                  <button className="hover:text-brand-500">R√©pondre</button>
                  <button className="hover:text-brand-500">Signaler</button>
                </div>
              </div>
            ))}
          </div>
        </div>
      );
    };

    // Vue reactions widget mount
    const mountVueReactions = (elId:string, post:Post, onUpdate:(r:any)=>void) => {
      const root = document.getElementById(elId);
      if (!root) return;
      root.classList.remove('hidden');
      const { createApp, reactive } = Vue;
      const state = reactive({ like: post.reactions.like, love: post.reactions.love, useful: post.reactions.useful });
      const app = createApp({
        template: `
          <div class="flex items-center gap-3">
            <button @click="like++" class="rounded-md px-3 py-2 bg-slate-100 dark:bg-slate-800 hover:bg-slate-200 dark:hover:bg-slate-700 transition-all">üëç {{ like }}</button>
            <button @click="love++" class="rounded-md px-3 py-2 bg-slate-100 dark:bg-slate-800 hover:bg-slate-200 dark:hover:bg-slate-700 transition-all">‚ù§Ô∏è {{ love }}</button>
            <button @click="useful++" class="rounded-md px-3 py-2 bg-slate-100 dark:bg-slate-800 hover:bg-slate-200 dark:hover:bg-slate-700 transition-all">üí° {{ useful }}</button>
          </div>
        `,
        setup() {
          return { ...state };
        },
        watch: {
          like(v:number){ onUpdate({ ...state, like: v }); },
          love(v:number){ onUpdate({ ...state, love: v }); },
          useful(v:number){ onUpdate({ ...state, useful: v }); },
        }
      });
      app.mount(root);
    };

    // Social share
    const ShareButtons = ({p}:{p:Post}) => {
      const share = (platform:string) => {
        const url = location.href;
        const text = encodeURIComponent(p.title);
        const map:any = {
          twitter: `https://twitter.com/intent/tweet?text=${text}&url=${url}`,
          facebook: `https://www.facebook.com/sharer/sharer.php?u=${url}`,
          linkedin: `https://www.linkedin.com/sharing/share-offsite/?url=${url}`,
        };
        window.open(map[platform], '_blank');
      };
      return (
        <div className="mt-6 flex items-center gap-2">
          <button onClick={()=>share('twitter')} className="rounded-md px-3 py-2 bg-slate-100 dark:bg-slate-800 hover:bg-slate-200">Partager Twitter</button>
          <button onClick={()=>share('facebook')} className="rounded-md px-3 py-2 bg-slate-100 dark:bg-slate-800 hover:bg-slate-200">Facebook</button>
          <button onClick={()=>share('linkedin')} className="rounded-md px-3 py-2 bg-slate-100 dark:bg-slate-800 hover:bg-slate-200">LinkedIn</button>
        </div>
      );
    };

    // Quick links
    const QuickLinks = () => (
      <div className="mx-auto max-w-6xl px-4 mt-6 grid grid-cols-2 sm:grid-cols-4 gap-3 text-sm">
        {['News','Gaming','Apps','Tutorials'].map(c => (
          <a key={c} href={`#/blog?category=${c}`} className="rounded-lg border border-slate-200 dark:border-slate-800 p-3 hover:bg-slate-50 dark:hover:bg-slate-900/60 transition-all">
            Parcourir {c}
          </a>
        ))}
      </div>
    );

    // Breadcrumbs
    const Breadcrumbs = ({trail}:{trail:{label:string; href?:string}[]}) => (
      <nav className="breadcrumbs text-xs text-slate-600 dark:text-slate-300">
        <ol className="flex items-center gap-1">
          {trail.map((t,i)=>(
            <li key={i} className="flex items-center">
              {t.href ? <a href={t.href} className="hover:text-brand-500">{t.label}</a> : <span>{t.label}</span>}
              {i < trail.length - 1 && <Icon name="chevronRight" className="w-4 h-4 mx-1" />}
            </li>
          ))}
        </ol>
      </nav>
    );

    // Home page
    const HomePage = () => {
      const trending = [...posts].sort((a,b)=>b.views - a.views).slice(0,6);
      const latest = [...posts].slice(0,8);
      return (
        <main className="pt-24">
          <div className="mx-auto max-w-6xl px-4">
            <Breadcrumbs trail={[{label:'Accueil'}]} />
          </div>
          <Hero />
          <QuickLinks />
          <section className="mx-auto max-w-6xl px-4 mt-10">
            <h2 className="text-2xl font-bold">Derniers articles</h2>
            <div className="mt-4 grid sm:grid-cols-2 lg:grid-cols-3 gap-6">
              {latest.map(p=> <PostCard key={p.id} p={p} />)}
            </div>
          </section>
          <section className="mx-auto max-w-6xl px-4 mt-10">
            <h2 className="text-2xl font-bold">Trending</h2>
            <div className="mt-4 grid sm:grid-cols-2 lg:grid-cols-3 gap-6">
              {trending.map(p=> <PostCard key={p.id} p={p} />)}
            </div>
          </section>
          <div className="mt-10"><NewsletterCTA /></div>
        </main>
      );
    };

    // Blog page with filters, search, infinite scroll
    const BlogPage = ({params}:{params:any}) => {
      const [q, setQ] = React.useState(params.q||'');
      const [suggests, setSuggests] = React.useState<string[]>([]);
      const [filters, setFilters] = React.useState({ category: params.category||'', date: '', popularity: '' });
      const [page, setPage] = React.useState(1);
      const [results, setResults] = React.useState<Post[]>(() => searchPosts(q, filters));
      React.useEffect(()=> {
        const handler = () => {
          if (window.innerHeight + window.scrollY >= document.body.offsetHeight - 100) {
            setPage(p => p+1);
          }
        };
        window.addEventListener('scroll', handler);
        return () => window.removeEventListener('scroll', handler);
      },[]);
      React.useEffect(()=> {
        setResults(searchPosts(q, filters));
        setSuggests(q ? suggest(q) : []);
      }, [q, filters]);
      const sliced = infiniteSlice(results, page, 9);
      return (
        <main className="pt-24">
          <div className="mx-auto max-w-6xl px-4">
            <Breadcrumbs trail={[{label:'Accueil', href:'#/'},{label:'Blog'}]} />
            <div className="mt-4 rounded-xl border border-slate-200 dark:border-slate-800 p-4">
              <div className="flex flex-col md:flex-row gap-3 md:items-center">
                <div className="flex-1 relative">
                  <Icon name="search" className="w-5 h-5 absolute left-3 top-3 text-slate-500" />
                  <input value={q} onChange={e=>setQ(e.target.value)} placeholder="Recherche en temps r√©el"
                    className="w-full rounded-md pl-10 pr-3 py-2 bg-white dark:bg-slate-800 border border-slate-300 dark:border-slate-700 outline-none focus:ring-2 focus:ring-brand-400"
                  />
                  {suggests.length>0 && (
                    <div className="absolute mt-1 w-full rounded-md border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 shadow">
                      {suggests.map(s=>(
                        <button key={s} onClick={()=>setQ(s)} className="block w-full text-left px-3 py-2 hover:bg-slate-50 dark:hover:bg-slate-800">{s}</button>
                      ))}
                    </div>
                  )}
                </div>
                <div className="grid grid-cols-2 md:grid-cols-3 gap-2">
                  <select value={filters.category} onChange={e=>setFilters(f=>({...f, category: e.target.value}))}
                    className="rounded-md px-2 py-2 bg-white dark:bg-slate-800 border border-slate-300 dark:border-slate-700">
                    <option value="">Cat√©gorie</option>
                    {['News','Gaming','Apps','Tutorials'].map(c=><option key={c} value={c}>{c}</option>)}
                  </select>
                  <select value={filters.popularity} onChange={e=>setFilters(f=>({...f, popularity: e.target.value}))}
                    className="rounded-md px-2 py-2 bg-white dark:bg-slate-800 border border-slate-300 dark:border-slate-700">
                    <option value="">Popularit√©</option>
                    <option value="medium">‚â• 100 vues</option>
                    <option value="high">‚â• 200 vues</option>
                  </select>
                  <input type="date" value={filters.date} onChange={e=>setFilters(f=>({...f, date: e.target.value}))}
                    className="rounded-md px-2 py-2 bg-white dark:bg-slate-800 border border-slate-300 dark:border-slate-700" />
                </div>
              </div>
              <div className="mt-3 text-xs text-slate-600 dark:text-slate-300">Historique: {searchesHist.slice().reverse().slice(0,5).join(' ‚Ä¢ ')}</div>
            </div>

            <div className="mt-6 grid sm:grid-cols-2 lg:grid-cols-3 gap-6">
              {sliced.map(p=> <PostCard key={p.id} p={p} />)}
            </div>
            {sliced.length < results.length ? (
              <div className="my-8 flex justify-center">
                <span className="text-sm text-slate-500">Chargement infini‚Ä¶ scroll pour plus</span>
              </div>
            ) : (
              <div className="my-8 flex justify-center">
                <span className="text-sm text-slate-500">Fin des r√©sultats</span>
              </div>
            )}
          </div>
        </main>
      );
    };

    // Related posts
    const relatedPosts = (p:Post) => {
      return posts.filter(x => x.id !== p.id && (x.category===p.category || x.tags.some(t=>p.tags.includes(t)))).slice(0,3);
    };

    // Post page
    const PostPage = ({params}:{params:any}) => {
      const post = posts.find(p => p.id === params.id) || posts[0];
      React.useEffect(()=> {
        post.views += 1;
        writeLS(LS.posts, posts);
        analytics.popular[post.id] = (analytics.popular[post.id]||0)+1;
        writeLS(LS.analytics, analytics);
        // Mount Vue reactions
        mountVueReactions('vue-reactions-root', post, (r)=> {
          post.reactions = r;
          writeLS(LS.posts, posts);
        });
      }, [post.id]);
      const toc = extractTOC(post.content);
      const prev = posts[posts.indexOf(post)-1];
      const next = posts[posts.indexOf(post)+1];
      return (
        <main className="pt-24">
          <div className="mx-auto max-w-6xl px-4">
            <Breadcrumbs trail={[{label:'Accueil', href:'#/'},{label:'Blog', href:'#/blog'},{label:post.title}]} />
            <article className="mt-6 grid grid-cols-1 lg:grid-cols-12 gap-8">
              <div className="lg:col-span-8">
                <img src={post.cover} alt="" className="w-full rounded-xl" />
                <div className="mt-4 flex items-center gap-3">
                  <CategoryBadge cat={post.category} />
                  <span className="text-xs text-slate-500">{new Date(post.date).toLocaleDateString('fr-FR')} ‚Ä¢ {post.readingTime} min ‚Ä¢ {post.views} vues</span>
                </div>
                <h1 className="mt-3 text-3xl font-extrabold">{post.title}</h1>
                <div className="mt-4">
                  <Markdown md={post.content} />
                </div>
                <ShareButtons p={post} />
                <div className="mt-6">
                  <h4 className="text-lg font-bold">R√©actions</h4>
                  <div id="vue-reactions-root" className="mt-2"></div>
                </div>
                <Comments postId={post.id} />
                <div className="mt-8 flex items-center justify-between">
                  <a href={prev ? `#/post?id=${prev.id}` : '#/blog'} className="inline-flex items-center gap-2 hover:text-brand-500"><Icon name="chevronLeft" /> {prev ? prev.title : 'Retour blog'}</a>
                  <a href={next ? `#/post?id=${next.id}` : '#/blog'} className="inline-flex items-center gap-2 hover:text-brand-500">{next ? next.title : 'Retour blog'} <Icon name="chevronRight" /></a>
                </div>
              </div>
              <aside className="lg:col-span-4">
                <div className="rounded-xl border border-slate-200 dark:border-slate-800 p-4">
                  <h4 className="font-bold">Table des mati√®res</h4>
                  <ul className="mt-2 space-y-1 text-sm">
                    {toc.map(i=>(
                      <li key={i.anchor} className="pl-2" style={{paddingLeft: (i.level-1)*8}}>
                        <a href={`#${i.anchor}`} onClick={(e)=>{ e.preventDefault(); document.getElementById(i.anchor)?.scrollIntoView({behavior:'smooth'}); }}>{i.text}</a>
                      </li>
                    ))}
                  </ul>
                </div>
                <div className="mt-6 rounded-xl border border-slate-200 dark:border-slate-800 p-4">
                  <h4 className="font-bold">Articles similaires</h4>
                  <div className="mt-2 space-y-3">
                    {relatedPosts(post).map(r=>(
                      <a key={r.id} href={`#/post?id=${r.id}`} className="block">
                        <div className="text-sm font-medium">{r.title}</div>
                        <div className="text-xs text-slate-500">{r.category} ‚Ä¢ {r.readingTime} min</div>
                      </a>
                    ))}
                  </div>
                </div>
              </aside>
            </article>
          </div>
        </main>
      );
    };

    // About page
    const AboutPage = () => (
      <main className="pt-24">
        <div className="mx-auto max-w-6xl px-4">
          <Breadcrumbs trail={[{label:'Accueil', href:'#/'},{label:'√Ä propos'}]} />
          <section className="mt-6 grid grid-cols-1 lg:grid-cols-12 gap-8">
            <div className="lg:col-span-8">
              <div className="rounded-xl border border-slate-200 dark:border-slate-800 p-6">
                <div className="flex items-center gap-4">
                  <img src={profile.avatar} alt="" className="w-20 h-20 rounded-full" />
                  <div>
                    <h2 className="text-2xl font-bold">Josu√©</h2>
                    <p className="text-slate-600 dark:text-slate-300">{profile.bio}</p>
                    <div className="mt-2 flex gap-3 text-sm">
                      <a href={profile.socials?.github||'#'} className="hover:text-brand-500">GitHub</a>
                      <a href={profile.socials?.twitter||'#'} className="hover:text-brand-500">Twitter</a>
                      <a href={profile.socials?.website||'#'} className="hover:text-brand-500">Website</a>
                    </div>
                  </div>
                </div>
                <div className="mt-6">
                  <h3 className="text-xl font-bold">Parcours</h3>
                  <ol className="mt-2 space-y-2 text-sm">
                    <li>2022 ‚Äî D√©but en React & Tailwind</li>
                    <li>2023 ‚Äî D√©ploiements Vercel, SEO avanc√©</li>
                    <li>2024 ‚Äî Admin panels, DB, Auth</li>
                    <li>2025 ‚Äî BujaDevil: Design + Performance + Accessibilit√©</li>
                  </ol>
                </div>
                <div className="mt-6">
                  <h3 className="text-xl font-bold">Comp√©tences</h3>
                  <div className="mt-2 flex flex-wrap gap-2">
                    <Badge label="React" color="#61dafb" />
                    <Badge label="Next" color="#000000" />
                    <Badge label="Tailwind" color="#38bdf8" />
                    <Badge label="Vercel" color="#000000" />
                    <Badge label="SEO" color="#16a34a" />
                    <Badge label="Accessibility" color="#0ea5e9" />
                  </div>
                </div>
                <div className="mt-6">
                  <h3 className="text-xl font-bold">Contact</h3>
                  <p className="text-sm">Email: contact@bujadevil.app (exemple)</p>
                </div>
              </div>
            </div>
            <aside className="lg:col-span-4">
              <div className="rounded-xl border border-slate-200 dark:border-slate-800 p-4">
                <h4 className="font-bold">Statut</h4>
                <div className="text-sm">En ligne: {profile.online ? 'Oui' : 'Non'}</div>
                <div className="text-sm">Derni√®re connexion: {new Date(profile.activity?.lastLogin||nowISO()).toLocaleString('fr-FR')}</div>
              </div>
            </aside>
          </section>
        </div>
      </main>
    );

    // Admin page
    const AdminPage = () => {
      const [draft, setDraft] = React.useState<Post>({
        id: uid(), title: '', excerpt: '', content: '', category: 'News', tags: [], cover: '', date: nowISO(), readingTime: 5, views: 0,
        reactions: { like:0, love:0, useful:0 }
      });
      const [media, setMedia] = React.useState<File|null>(null);
      const stats = {
        visits: analytics.visits,
        pageViews: analytics.pageViews,
        avgSession: analytics.sessionDurations.length ? Math.round(analytics.sessionDurations.reduce((a:number,b:number)=>a+b,0)/analytics.sessionDurations.length) : 0,
        popularTop: Object.entries(analytics.popular).sort((a:any,b:any)=>b[1]-a[1]).slice(0,3).map(([id,count])=>({ id, count })),
        sources: analytics.sources,
      };

      const publish = () => {
        if (!draft.title || !draft.content) return alert('Titre et contenu requis');
        posts.unshift(draft);
        writeLS(LS.posts, posts);
        setDraft({ ...draft, id: uid(), title:'', excerpt:'', content:'', tags:[], cover:'', date: nowISO() });
        alert('Publication programm√©e (mock)');
      };

      const onFile = (e:any) => {
        const f = e.target.files?.[0];
        if (!f) return;
        setMedia(f);
        const reader = new FileReader();
        reader.onload = () => { setDraft(d=>({...d, cover: reader.result as string})); };
        reader.readAsDataURL(f);
      };

      return (
        <main className="pt-24">
          <div className="mx-auto max-w-6xl px-4">
            <Breadcrumbs trail={[{label:'Accueil', href:'#/'},{label:'Admin'}]} />
            <div className="grid grid-cols-1 lg:grid-cols-12 gap-8 mt-6">
              <section className="lg:col-span-8">
                <div className="rounded-xl border border-slate-200 dark:border-slate-800 p-4">
                  <h3 className="text-xl font-bold">√âditeur Markdown</h3>
                  <div className="mt-3 grid grid-cols-1 md:grid-cols-2 gap-3">
                    <input placeholder="Titre" value={draft.title} onChange={e=>setDraft(d=>({...d, title: e.target.value}))}
                      className="rounded-md px-3 py-2 bg-white dark:bg-slate-800 border"/>
                    <select value={draft.category} onChange={e=>setDraft(d=>({...d, category: e.target.value as Category}))}
                      className="rounded-md px-3 py-2 bg-white dark:bg-slate-800 border">
                      {['News','Gaming','Apps','Tutorials'].map(c=><option key={c} value={c}>{c}</option>)}
                    </select>
                    <input placeholder="Tags (s√©par√©s par ,)" value={draft.tags.join(',')} onChange={e=>setDraft(d=>({...d, tags: e.target.value.split(',').map(x=>x.trim()).filter(Boolean)}))}
                      className="rounded-md px-3 py-2 bg-white dark:bg-slate-800 border md:col-span-2"/>
                    <textarea placeholder="Excerpt" value={draft.excerpt} onChange={e=>setDraft(d=>({...d, excerpt: e.target.value}))}
                      className="rounded-md px-3 py-2 bg-white dark:bg-slate-800 border md:col-span-2" rows={2}/>
                    <textarea placeholder="Contenu Markdown" value={draft.content} onChange={e=>setDraft(d=>({...d, content: e.target.value}))}
                      className="rounded-md px-3 py-2 bg-white dark:bg-slate-800 border md:col-span-2" rows={10}/>
                    <div className="md:col-span-2">
                      <label className="block text-sm mb-1">Upload m√©dia (drag & drop)</label>
                      <input type="file" onChange={onFile} className="rounded-md px-3 py-2 bg-white dark:bg-slate-800 border w-full"/>
                      {draft.cover && <img src={draft.cover} alt="" className="mt-2 w-full h-40 object-cover rounded-md" />}
                    </div>
                    <button onClick={publish} className="rounded-md px-4 py-2 bg-brand-600 text-white hover:bg-brand-500 md:col-span-2">Publier</button>
                  </div>
                </div>
              </section>
              <aside className="lg:col-span-4">
                <div className="rounded-xl border border-slate-200 dark:border-slate-800 p-4">
                  <h4 className="font-bold">Statistiques en temps r√©el (mock)</h4>
                  <ul className="mt-2 text-sm space-y-1">
                    <li>Visites: {stats.visits}</li>
                    <li>Pages vues: {stats.pageViews}</li>
                    <li>Dur√©e moyenne session: {stats.avgSession}s</li>
                    <li>Top articles: {stats.popularTop.map(p=>p.id).join(', ')||'‚Äî'}</li>
                    <li>Sources: {Object.entries(stats.sources).map(([k,v])=>`${k}:${v}`).join(', ')||'‚Äî'}</li>
                  </ul>
                  <div className="mt-4">
                    <h5 className="font-semibold">Mod√©ration</h5>
                    <p className="text-sm text-slate-600 dark:text-slate-300">Signaler, spam, validation ‚Äî UI simplifi√©e.</p>
                  </div>
                </div>
              </aside>
            </div>
          </div>
        </main>
      );
    };

    // Profile / backoffice users
    const ProfilePage = () => {
      const [p, setP] = React.useState(profile);
      const updatePrefs = (k:'theme'|'focus'|'fontSize', v:any) => {
        p.prefs = { ...(p.prefs||{}), [k]: v };
        writeLS(LS.profile, p);
        setP({...p});
        if (k==='theme') { applyTheme(v); writeLS(LS.prefs, {...prefs, theme: v}); }
        if (k==='focus') { writeLS(LS.prefs, {...prefs, focus: v}); }
        if (k==='fontSize') { document.documentElement.style.setProperty('--fontSize', v+'px'); }
      };
      return (
        <main className="pt-24">
          <div className="mx-auto max-w-6xl px-4">
            <Breadcrumbs trail={[{label:'Accueil', href:'#/'},{label:'Profil'}]} />
            <div className="grid grid-cols-1 lg:grid-cols-12 gap-8 mt-6">
              <section className="lg:col-span-8">
                <div className="rounded-xl border border-slate-200 dark:border-slate-800 p-4">
                  <h3 className="text-xl font-bold">Profil personnel</h3>
                  <div className="mt-3 flex items-center gap-4">
                    <img src={p.avatar} alt="" className="w-20 h-20 rounded-full" />
                    <div className="flex-1">
                      <input value={p.name} onChange={e=>{ p.name = e.target.value; writeLS(LS.profile, p); setP({...p}); }}
                        className="rounded-md px-3 py-2 bg-white dark:bg-slate-800 border w-full" />
                      <textarea value={p.bio||''} onChange={e=>{ p.bio = e.target.value; writeLS(LS.profile, p); setP({...p}); }}
                        className="mt-2 rounded-md px-3 py-2 bg-white dark:bg-slate-800 border w-full" />
                    </div>
                  </div>
                  <div className="mt-4">
                    <h4 className="font-semibold">Pr√©f√©rences</h4>
                    <div className="mt-2 grid grid-cols-1 sm:grid-cols-3 gap-3 text-sm">
                      <select value={p.prefs?.theme||'system'} onChange={e=>updatePrefs('theme', e.target.value)}
                        className="rounded-md px-3 py-2 bg-white dark:bg-slate-800 border">
                        <option value="system">System</option>
                        <option value="light">Light</option>
                        <option value="dark">Dark</option>
                      </select>
                      <label className="flex items-center gap-2"><input type="checkbox" checked={p.prefs?.focus||false} onChange={e=>updatePrefs('focus', e.target.checked)} /> Mode lecture concentr√©</label>
                      <input type="range" min="14" max="20" value={p.prefs?.fontSize||16} onChange={e=>updatePrefs('fontSize', Number(e.target.value))} />
                    </div>
                  </div>
                  <div className="mt-4">
                    <h4 className="font-semibold">Notifications</h4>
                    <label className="flex items-center gap-2 text-sm"><input type="checkbox" checked={p.notifications?.newsletter||false} onChange={e=>{ p.notifications!.newsletter = e.target.checked; writeLS(LS.profile, p); setP({...p}); }} /> Newsletter</label>
                    <label className="flex items-center gap-2 text-sm"><input type="checkbox" checked={p.notifications?.comments||false} onChange={e=>{ p.notifications!.comments = e.target.checked; writeLS(LS.profile, p); setP({...p}); }} /> Commentaires</label>
                  </div>
                </div>
                <div className="mt-6 rounded-xl border border-slate-200 dark:border-slate-800 p-4">
                  <h4 className="font-semibold">Favoris & communaut√©</h4>
                  <div className="mt-2 grid sm:grid-cols-2 lg:grid-cols-3 gap-4">
                    {(p.bookmarks||[]).map(id => {
                      const b = posts.find(x=>x.id===id)!;
                      return <PostCard key={id} p={b} />;
                    })}
                    {(p.bookmarks||[]).length===0 && <div className="text-sm text-slate-600 dark:text-slate-300">Aucun bookmark pour l'instant.</div>}
                  </div>
                </div>
              </section>
              <aside className="lg:col-span-4">
                <div className="rounded-xl border border-slate-200 dark:border-slate-800 p-4">
                  <h4 className="font-bold">Badges & achievements</h4>
                  <div className="mt-2 flex flex-wrap gap-2">
                    {(p.achievements||[]).map(b => <Badge key={b} label={b} color="#0ea5e9" />)}
                  </div>
                  <div className="mt-4">
                    <h5 className="font-semibold">Login social (mock)</h5>
                    <div className="flex gap-2">
                      <button className="rounded-md px-3 py-2 bg-slate-100 dark:bg-slate-800 hover:bg-slate-200">Google</button>
                      <button className="rounded-md px-3 py-2 bg-slate-100 dark:bg-slate-800 hover:bg-slate-200">GitHub</button>
                    </div>
                  </div>
                </div>
              </aside>
            </div>
          </div>
        </main>
      );
    };

    // Root App
    const App = () => {
      const [route, setRoute] = React.useState(parseHash());
      React.useEffect(()=> {
        const onHash = () => setRoute(parseHash());
        window.addEventListener('hashchange', onHash);
        tickView(route.path);
        return () => window.removeEventListener('hashchange', onHash);
      }, [route.path]);

      const toggleTheme = () => {
        const next = prefs.theme==='dark' ? 'light' : prefs.theme==='light' ? 'system' : 'dark';
        applyTheme(next);
        writeLS(LS.prefs, {...prefs, theme: next});
      };

      const Page = () => {
        switch (route.path) {
          case '/': return <HomePage />;
          case '/blog': return <BlogPage params={route.params} />;
          case '/post': return <PostPage params={route.params} />;
          case '/about': return <AboutPage />;
          case '/admin': return <AdminPage />;
          case '/profile': return <ProfilePage />;
          default: return <HomePage />;
        }
      };

      return (
        <div className="min-h-screen" style={{ fontSize: (prefs.fontSize||16) + 'px' }}>
          <Header onThemeToggle={toggleTheme} />
          <Page />
          <Footer />
        </div>
      );
    };

    // Mount app
    ReactDOM.createRoot(document.getElementById('app')!).render(<App />);
  </script>
</body>
  </html>
  
